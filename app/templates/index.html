<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>AI Agent - Pixel Pasta</title>
    <!-- Link do zewnętrznego pliku CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <!-- Biblioteka do renderowania Markdown po stronie klienta -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <!-- Czcionka Pixel -->
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
</head>
<body>
    <div class="pixel-background">
        <div class="header-banner">
            <div class="pixel-title">AI AGENT</div>
        </div>
        
        <div class="main-container">
            <div class="card">
                <div class="card-header">
                    <h1>AI AGENT - PIXEL PASTA</h1>
                </div>
                <p>Asystent AI do złożonych zadań. Wprowadź zapytanie i opcjonalnie dodaj pliki jako kontekst.</p>
             <div class="api-key-section">
                 <label for="apiKeyInput">Klucz API OpenRouter:</label>
                 <input type="password" id="apiKeyInput" placeholder="Wklej swój klucz API tutaj...">
                 <small>Twój klucz API jest używany tylko do komunikacji z OpenRouter i nie jest przechowywany na serwerze.</small>
             </div>
        </div>

        <div class="card file-upload">
            <div class="card-header">
                <h2>Załaduj dokumenty</h2>
            </div>
            <p>Obsługiwane formaty: PDF, TXT, JPG, PNG, MD. Maks. 4 pliki.</p>
            <input type="file" id="documentUpload" accept=".pdf,.txt,.jpg,.jpeg,.png,.md" multiple>
            <button class="btn" onclick="handleFileUpload()">Przetwórz wybrane pliki</button>
            <div class="files-list" id="filesList"></div>
        </div>

        <div class="card query-section">
            <div class="card-header">
                <h2>Zapytanie / Polecenie</h2>
            </div>
            <textarea id="queryInput" placeholder="Wprowadź swoje pytanie, polecenie lub problem do rozwiązania tutaj..."></textarea>
            <button class="btn" onclick="sendQuery()">Wyślij zapytanie do Agenta AI</button>
        </div>

        <div class="loading" id="loadingIndicator">
            <div class="pixel-spinner"></div>
            <p class="pixel-text">Agent AI przetwarza Twoje zapytanie...</p>
            <p id="loadingStatus"></p>
        </div>

        <div id="errorContainer" style="display: none;">
            <div class="error-message" id="errorMessage"></div>
        </div>

        <div class="card response-section" id="responseContainer" style="display: none;">
            <div class="card-header">
                <h2>Odpowiedź Agenta AI</h2>
            </div>
            <div id="pipelineSteps"></div>
            <hr style="margin: 25px 0; border: 0; border-top: 1px solid #eee;">
            <div class="module-response" id="finalResponseCard">
                <div class="response-header pixel-text">Odpowiedź Końcowa</div>
                <div class="response-content" id="finalResponse"></div>
            </div>
        </div>
    </div>

    <!-- Link do zewnętrznego pliku JavaScript -->
    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>
